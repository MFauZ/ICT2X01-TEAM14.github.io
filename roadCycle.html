<!DOCTYPE>
<html>

<head>
    <title>PCN</title>
    <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-aabb-collider-component@%5E2.2.1/dist/aframe-aabb-collider-component.min.js"></script>
    <script src="https://unpkg.com/aframe-border-component@0.1.3/dist/aframe-border-component.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
    <script src="js/editFunctions.js"></script>
    <script src="js/scenarioJS.js"></script>
</head>

<body>
    <a-scene>
        <!--Load Assets-->
        <a-assets>
            <a-mixin id="checkpoint"></a-mixin>
            <!--Models-->
            <a-asset-item id="cop-obj" src="images/cop/cop.obj"></a-asset-item>
            <a-asset-item id="cop-mtl" src="images/cop/copMaterial.mtl"></a-asset-item>
            <a-asset-item id="policeCar" src="images/policeCar/1396 Police Car.gltf"></a-asset-item>
            <a-asset-item id="gtr" src="images/nissanGTR/GTR.gltf"></a-asset-item>
            <a-asset-item id="bike" src="images/motorcycle/Motorcycle.gltf"></a-asset-item>
            <a-asset-item id="portal" src="images/portal/Portal_01.gltf"></a-asset-item>
            <a-asset-item id="trafficLight" src="images/trafficLight/model.gltf"></a-asset-item>
            <a-asset-item id="stopSign-obj" src="images/stopSign/stopSign.obj"></a-asset-item>
            <a-asset-item id="stopSign-mtl" src="images/stopSign/stopSignMaterial.mtl"></a-asset-item>
            <a-asset-item id="teacher" src="images/teacher/Teacher.gltf"></a-asset-item>
            <a-asset-item id="cone-obj" src="images/cone/cone.obj"></a-asset-item>
            <a-asset-item id="cone-mtl" src="images/cone/coneMaterial.mtl"></a-asset-item>
            <!--Images-->
            <img id="bicycleHandle" src="images/bicycle_handle.png">
            <img id="road" src="images/road1.jpg">
            <img id="zebra" src="images/zebraCrossing.png">
            <img id="HDB1" src="images/HDB1.png">
            <img id="HDB2" src="images/HDB2.png">
            <img id="grass1" src="images/sideGrass1.png">
            <img id="footpath1" src="images/footpath1.png">
            <img id="helmet" src="images/helmet.png">
            <img id="vestImg" src="images/vest.png">
        </a-assets>

        <!--Skybox-->

        <!--Camera-->
        <a-entity id="rig" bound-collider geometry="primitive: box;" aabb-collider="objects: a-box" position="-20 0 0"
            movement-controls="controls: checkpoint" checkpoint-controls="mode: animate; animateSpeed: 15">
            <a-entity camera position="0 10 0" look-controls="pointerLockEnabled: true">
                <a-entity cursor="fuse: true;" position="0 0 -1" geometry="primitive: ring; radiusInner: 0.015; radiusOuter: 0.03;"
                    material="color: red" raycaster="objects: .entities">
                    <a-animation begin="click" easing="ease-in" attribute="scale" dur="150" fill="backwards" from="0.1 0.1 0.1"
                        to="1 1 1"></a-animation>
                    <a-animation begin="fusing" easing="ease-in" attribute="scale" dur="1500" fill="backwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
                </a-entity>
        
                <!--HUDs-->
                <a-image src="#bicycleHandle" width="2" position="0 -0.7 -1" alpha-test="0.5"></a-image>
                <a-image id="helmetCheck" src="#helmet" scale="-1" width="1.5" position="-5.3 2 -4" alpha-test="0.5" visible="false"></a-image>
                <a-image id="vestCheck" src="#vestImg" scale="-1" width="2" height="2" position="-6 0 -4.5" alpha-test="0.5"
                    visible="false"></a-image>
            </a-entity>
        </a-entity>

        <!--Environment Images-->
        <a-image class="non-clickable" src="#road" height="1500" width="90" position="11.6 0 -700" rotation="-90 0 0"
            repeat="1 50" static-body></a-image>
        <a-image class="non-clickable" src="#grass1" height="1500" width="10" position="-38.40 0 -700" rotation="-90 0 0"
            repeat="1 50"></a-image>
        <a-image class="non-clickable" src="#grass1" height="1500" width="10" position="61.6 0 -700" rotation="-90 0 0"
            repeat="1 100"></a-image>
        <a-image class="non-clickable" src="#footpath1" height="1500" width="10" position="-48.40 0 -700" rotation="-90 0 0"
            repeat="1 50"></a-image>
        <a-image class="non-clickable" src="#footpath1" height="1500" width="10" position="71.6 0 -700" rotation="-90 0 0"
            repeat="1 50"></a-image>
        <a-image class="non-clickable" src="#HDB1" height="1500" width="250" position="-54 122 -700" rotation="0 -90 -90"
            repeat="1 3"></a-image>
        <a-image class="non-clickable" src="#HDB2" height="1500" width="250" position="77.75 122 -700" rotation="0 -90 -90"
            repeat="1 3"></a-image>
        <a-image class="non-clickable" src="#zebra" height="90" width="108" position="11.5 .2 -500" rotation="-90 0 0" static-body></a-image>

        <!--NPCs-->
        <a-obj-model class="entities" onclick="safetyToggle()" id="cop" src="#cop-obj" mtl="#cop-mtl" position="-38 7.4 -70"
            rotation="0 -90 0" scale="2.5 3 2.5" visible="false">
            <a-text value="SCTF Officer" color="#111111" position="2.5 1.5 0" width="20" rotation="0 180 0"></a-text>
        </a-obj-model>

        <!--Environment Objects-->
        <a-entity id="trafficLight1" class="non-clickable" gltf-model="#trafficLight" rotation="180 180 180" position="-40 -7 -470" scale="15 15 15"></a-entity>
        <a-entity id="trafficLight2" class="non-clickable" gltf-model="#trafficLight" rotation="180 180 180" position="60 -7 -470" scale="15 15 15"></a-entity>
        <a-entity id="trafficLight3" class="non-clickable" gltf-model="#trafficLight" rotation="0 180 0" position="60 -7 -530" scale="15 15 15"></a-entity>
        <a-entity id="trafficLight4" class="non-clickable" gltf-model="#trafficLight" rotation="0 180 0" position="-40 -7 -530" scale="15 15 15"></a-entity>

        <!--Vehicles-->
        <a-entity id="policeCar1" class="non-clickable" gltf-model="#policeCar" rotation="180 0 180" scale=".35 .35 .35">
            <a-animation attribute="position" dur="10000" from="-6.15 -0.4 25" to="-6.15 -0.4 -1375" repeat="indefinite"></a-animation>
        </a-entity>
        <a-entity id="bike1" class="non-clickable" gltf-model="#bike" rotation="180 0 180" scale="2 2 2">
            <a-animation attribute="position" dur="8000" from="-5 4.75 25" to="-6.15 -0.4 -1375" repeat="indefinite" easing="linear"></a-animation>
        </a-entity>
        <a-entity id="gtr1" class="non-clickable" gltf-model="#gtr" rotation="180 180 180" scale="6 6 6">
            <a-animation attribute="position" dur="5000" from="20.6 4.6 -1400" to="20.6 4.6 70" repeat="indefinite" easing="linear"></a-animation>
        </a-entity>
        
        <!--Pedestrians-->
        <a-entity id="pedestrian1" class="non-clickable" gltf-model="#teacher" rotation="180 0 180" scale=".8 .8 .8">
            <a-text value="Old Man 1" color="#111111" position="5 15 0" rotation="0 180 0" width="50"></a-text>
            <a-animation attribute="position" dur="40000" from="-45 0 10" to="-45 0 -1400" repeat="indefinite"></a-animation>
        </a-entity>
        <a-entity id="pedestrian3" class="non-clickable" gltf-model="#teacher" rotation="180 0 180" scale=".8 .8 .8">
            <a-text value="Old Man 2" color="#111111" position="5 15 0" rotation="0 180 0" width="50"></a-text>
            <a-animation attribute="position" dur="40000" from="-50 0 10" to="-45 0 -1400" repeat="indefinite" delay="1000"></a-animation>
        </a-entity>
        <a-entity id="pedestrian2" class="non-clickable" gltf-model="#teacher" rotation="180 0 180" scale=".8 .8 .8">
            <a-text value="Young Man 1" color="#111111" position="5 15 0" rotation="0 180 0" width="50"></a-text>
            <a-animation attribute="position" dur="20000" from="-50 0 20" to="-45 0 -1400" repeat="indefinite" ease="linear"></a-animation>
        </a-entity>

        <!--Collision Trigger Test-->
        <a-box class="non-clickable" bound-collider="" static-body="" position="-14 2 -25" width="40" height="4" color="#FFC65D"
            material="color:#808080" id="bound1" class="box" opacity="0"></a-box>

        <!-- Checkpoints -->
        <a-entity id="portal1" class="entities" gltf-model="#portal" position="-25 0 -50" rotation="0 180 0" scale=".7 .7 .7">
            <a-box checkpoint="" width="10" height="15" position="0 7 0" opacity="0"></a-box>
            <a-text value="Portal 1" color="#111111" position="3 17 0" rotation="0 180 0" width="50"></a-text>
        </a-entity>
        <a-entity id="portal2" class="entities" gltf-model="#portal" position="-10 0 -100" rotation="0 180 0" scale=".7 .7 .7">
            <a-box checkpoint="" width="10" height="15" position="0 7 0" opacity="0"></a-box>
            <a-text value="Portal 2" color="#111111" position="3 17 0" rotation="0 180 0" width="50"></a-text>
        </a-entity>
    </a-scene>
</body>

</html>